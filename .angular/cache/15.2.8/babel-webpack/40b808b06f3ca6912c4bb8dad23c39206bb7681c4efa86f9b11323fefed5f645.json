{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.JavaAddComponent = void 0;\nconst core_1 = require(\"@angular/core\");\nconst java_messages_1 = require(\"../java/java-messages\");\nconst interfaces_1 = require(\"../utilities/interfaces\");\nconst _constants = require(\"../utilities/constants-angular\");\nconst i0 = require(\"@angular/core\");\nconst i1 = require(\"../workspace/workspace-service\");\nconst i2 = require(\"../java/java-service\");\nconst i3 = require(\"ngx-electronyzer\");\nconst i4 = require(\"../utilities/utilities\");\nconst i5 = require(\"@angular/router\");\nconst i6 = require(\"@angular/forms\");\nconst i7 = require(\"@po-ui/ng-components\");\nconst _c0 = [\"po_javaParams\"];\nconst CNST_FIELD_NAMES = [{\n  key: 'name',\n  value: 'Nome da configuração*'\n}];\nlet JavaAddComponent = /*#__PURE__*/(() => {\n  class JavaAddComponent {\n    constructor(_workspaceService, _javaService, _electronService, _utilities, _router) {\n      this._workspaceService = _workspaceService;\n      this._javaService = _javaService;\n      this._electronService = _electronService;\n      this._utilities = _utilities;\n      this._router = _router;\n      this.modal = false;\n      this.javaObject = null;\n      this.closeModal = new core_1.EventEmitter();\n      this.CNST_MESSAGES = {\n        JAVA_VALIDATE: 'Validando configuração do java...',\n        JAVA_SAVE_ERROR_NO_PARAMETERS: 'Nenhum parâmetro foi informado nesta configuração do java.'\n      };\n      /*************************************************/\n      /*************************************************/\n      /*************************************************/\n      this.po_gridActions = {\n        beforeRemove: this.onBeforeRemove.bind(this),\n        beforeInsert: this.onBeforeInsert.bind(this)\n      };\n      this.po_columns = [{\n        property: 'value',\n        label: 'Parâmetro',\n        width: 260,\n        required: true,\n        editable: true\n      }];\n      this.java = new interfaces_1.Java();\n      this.po_lo_text = {\n        value: null\n      };\n      this._CNST_FIELD_NAMES = CNST_FIELD_NAMES;\n      this._CNST_NEW_PARAMETER_VALUE = _constants.CNST_NEW_PARAMETER_VALUE;\n      this.lbl_name = this._CNST_FIELD_NAMES.find(v => {\n        return v.key == 'name';\n      }).value;\n      let nav = this._router.getCurrentNavigation();\n      if (this.javaObject) {\n        this.java = this.javaObject;\n      } else if (nav != undefined && nav.extras.state) {\n        Object.getOwnPropertyNames.call(Object, nav.extras.state).map(p => {\n          this.java[p] = nav.extras.state[p];\n        });\n      }\n      if (this.java.id != null) {\n        this.operation = 'Alterar Configuração do Java';\n      } else {\n        this.operation = 'Cadastrar nova Configuração do Java';\n      }\n    }\n    onBeforeInsert(row) {\n      let valid = false;\n      let new_parameter = this.java.parameters.filter(p => {\n        return p.value === this._CNST_NEW_PARAMETER_VALUE;\n      })[0];\n      if (new_parameter === undefined) {\n        this.java.parameters.push(row);\n        valid = true;\n      }\n      return valid;\n    }\n    onBeforeRemove() {\n      this.clearUnusedParameters();\n    }\n    clearUnusedParameters() {\n      this.java.parameters = this.java.parameters.filter(p => {\n        p.value = p.value.replace(/\\s+/g, '');\n        return p.value != null && p.value != '' && p.value != this._CNST_NEW_PARAMETER_VALUE;\n      });\n    }\n    validateJava() {\n      this._utilities.writeToLog(_constants.CNST_LOGLEVEL.DEBUG, this.CNST_MESSAGES.JAVA_VALIDATE);\n      this.po_lo_text = {\n        value: this.CNST_MESSAGES.JAVA_VALIDATE\n      };\n      let java = new interfaces_1.Java();\n      let propertiesNotDefined = Object.getOwnPropertyNames.call(Object, java).map(p => {\n        if (this.java[p] == undefined && p != 'id') return p;\n      }).filter(p => {\n        return p != null;\n      });\n      // Validação dos campos de formulário //\n      if (propertiesNotDefined.length > 0) {\n        this._utilities.createNotification(_constants.CNST_LOGLEVEL.ERROR, 'Campo obrigatório \"' + this._CNST_FIELD_NAMES.find(f => {\n          return f.key === propertiesNotDefined[0];\n        }).value + '\" não preenchido.');\n        this.po_lo_text = {\n          value: null\n        };\n        return false;\n      } else if (this.java.parameters.length == 0) {\n        this._utilities.createNotification(_constants.CNST_LOGLEVEL.ERROR, this.CNST_MESSAGES.JAVA_SAVE_ERROR_NO_PARAMETERS);\n        this.po_lo_text = {\n          value: null\n        };\n        return false;\n      } else {\n        return true;\n      }\n    }\n    goBack(newJava) {\n      if (this.modal) {\n        this.closeModal.emit(newJava);\n      } else {\n        this._router.navigate(['/java']);\n      }\n    }\n    saveJava() {\n      this.clearUnusedParameters();\n      if (this.validateJava()) {\n        this._javaService.saveJavaConfiguration(this.java).subscribe(b => {\n          this._utilities.createNotification(_constants.CNST_LOGLEVEL.INFO, java_messages_1.CNST_JAVA_MESSAGES.JAVA_SAVE_OK);\n          this.po_lo_text = {\n            value: null\n          };\n          this.goBack(this.java);\n        }, err => {\n          this._utilities.createNotification(_constants.CNST_LOGLEVEL.ERROR, java_messages_1.CNST_JAVA_MESSAGES.JAVA_SAVE_ERROR(this.java.name), err);\n          this.po_lo_text = {\n            value: null\n          };\n        });\n      }\n    }\n  }\n  JavaAddComponent.ɵfac = function JavaAddComponent_Factory(t) {\n    return new (t || JavaAddComponent)(i0.ɵɵdirectiveInject(i1.WorkspaceService), i0.ɵɵdirectiveInject(i2.JavaService), i0.ɵɵdirectiveInject(i3.ElectronService), i0.ɵɵdirectiveInject(i4.Utilities), i0.ɵɵdirectiveInject(i5.Router));\n  };\n  JavaAddComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: JavaAddComponent,\n    selectors: [[\"app-java-add\"]],\n    viewQuery: function JavaAddComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.javaParams = _t.first);\n      }\n    },\n    inputs: {\n      modal: \"modal\",\n      javaObject: \"javaObject\"\n    },\n    outputs: {\n      closeModal: \"closeModal\"\n    },\n    decls: 14,\n    vars: 8,\n    consts: [[3, \"p-title\"], [\"p-screen-lock\", \"true\", 3, \"hidden\", \"p-text\"], [\"javaForm\", \"ngForm\"], [1, \"po-row\"], [\"name\", \"po_java\", \"p-required\", \"true\", 1, \"form-control\", \"po-md-12\", \"po-lg-12\", 3, \"p-label\", \"ngModel\", \"ngModelChange\"], [1, \"po-row\", \"padding-button\"], [\"p-size\", \"medium\", \"p-label\", \"Novo par\\u00E2metro\", 1, \"po-button\", \"removeBorder\", \"padding-0\", 3, \"p-click\"], [1, \"form-group\", \"po-row\"], [1, \"form-control\", \"po-md-12\", \"po-lg-12\", 3, \"p-data\", \"p-columns\", \"p-row-actions\"], [\"po_javaParams\", \"\"], [1, \"po-row\", \"footer\"], [\"p-size\", \"medium\", \"p-label\", \"Voltar\", 1, \"po-button\", \"removeBorder\", \"padding-0\", 3, \"p-click\"], [\"p-size\", \"medium\", \"p-label\", \"Salvar\", \"p-kind\", \"primary\", 1, \"po-button\", \"removeBorder\", \"padding-0\", 3, \"p-click\"]],\n    template: function JavaAddComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"po-page-list\", 0);\n        i0.ɵɵelement(1, \"po-loading-overlay\", 1);\n        i0.ɵɵelementStart(2, \"form\", null, 2)(4, \"div\", 3)(5, \"po-input\", 4);\n        i0.ɵɵlistener(\"ngModelChange\", function JavaAddComponent_Template_po_input_ngModelChange_5_listener($event) {\n          return ctx.java.name = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(6, \"div\", 5)(7, \"po-button\", 6);\n        i0.ɵɵlistener(\"p-click\", function JavaAddComponent_Template_po_button_p_click_7_listener() {\n          return ctx.onBeforeInsert({\n            value: ctx._CNST_NEW_PARAMETER_VALUE\n          });\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(8, \"div\", 7);\n        i0.ɵɵelement(9, \"po-grid\", 8, 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"div\", 10)(12, \"po-button\", 11);\n        i0.ɵɵlistener(\"p-click\", function JavaAddComponent_Template_po_button_p_click_12_listener() {\n          return ctx.goBack();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"po-button\", 12);\n        i0.ɵɵlistener(\"p-click\", function JavaAddComponent_Template_po_button_p_click_13_listener() {\n          return ctx.saveJava();\n        });\n        i0.ɵɵelementEnd()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵpropertyInterpolate(\"p-title\", ctx.operation);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"hidden\", ctx.po_lo_text.value == null)(\"p-text\", ctx.po_lo_text.value);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"p-label\", ctx.lbl_name)(\"ngModel\", ctx.java.name);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"p-data\", ctx.java.parameters)(\"p-columns\", ctx.po_columns)(\"p-row-actions\", ctx.po_gridActions);\n      }\n    },\n    dependencies: [i6.ɵNgNoValidate, i6.NgControlStatus, i6.NgControlStatusGroup, i6.NgModel, i6.NgForm, i7.PoLoadingOverlayComponent, i7.PoPageListComponent, i7.PoInputComponent, i7.PoButtonComponent, i7.PoGridComponent]\n  });\n  return JavaAddComponent;\n})();\nexports.JavaAddComponent = JavaAddComponent;","map":null,"metadata":{},"sourceType":"script","externalDependencies":[]}