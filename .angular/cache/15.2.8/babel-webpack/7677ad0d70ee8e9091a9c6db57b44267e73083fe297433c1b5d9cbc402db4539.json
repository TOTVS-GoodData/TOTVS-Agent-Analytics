{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.WorkspaceComponent = void 0;\nconst workspace_messages_1 = require(\"../workspace/workspace-messages\");\nconst constants_angular_1 = require(\"../utilities/constants-angular\");\nconst rxjs_1 = require(\"rxjs\");\nconst i0 = require(\"@angular/core\");\nconst i1 = require(\"ngx-electronyzer\");\nconst i2 = require(\"./workspace-service\");\nconst i3 = require(\"../database/database-service\");\nconst i4 = require(\"../utilities/utilities\");\nconst i5 = require(\"@angular/router\");\nconst i6 = require(\"@angular/forms\");\nconst i7 = require(\"@po-ui/ng-components\");\nconst _c0 = [\"modal_1\"];\nconst _c1 = [\"modal_2\"];\nfunction WorkspaceComponent_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 1);\n    i0.ɵɵelement(1, \"po-info\", 16)(2, \"po-info\", 17)(3, \"po-info\", 18)(4, \"po-info\", 19);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r4 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"p-value\", item_r4.GDWorkspaceId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"p-value\", item_r4.GDProcessGraph);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"p-value\", item_r4.databaseName);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"p-value\", item_r4.contractType);\n  }\n}\nlet WorkspaceComponent = /*#__PURE__*/(() => {\n  class WorkspaceComponent {\n    setoptions() {\n      return [{\n        label: 'Editar',\n        action: this.editProject.bind(this)\n      }, {\n        label: 'Excluir',\n        action: this.deleteProject.bind(this)\n      }];\n    }\n    constructor(_electronService, _workspaceService, _databaseService, _utilities, _router) {\n      this._electronService = _electronService;\n      this._workspaceService = _workspaceService;\n      this._databaseService = _databaseService;\n      this._utilities = _utilities;\n      this._router = _router;\n      this.databases = [];\n      this.projects = [];\n      this.contractType = null;\n      this.contractCode = null;\n      this.po_lo_text = {\n        value: null\n      };\n      this._CNST_MODALIDADE_CONTRATACAO = constants_angular_1.CNST_MODALIDADE_CONTRATACAO;\n    }\n    ngOnInit() {\n      this.loadWorkspaces();\n    }\n    loadWorkspaces() {\n      this.po_lo_text = {\n        value: workspace_messages_1.CNST_WORKSPACE_MESSAGES.WORKSPACE_LOADING\n      };\n      (0, rxjs_1.forkJoin)([this._workspaceService.getWorkspaces(), this._databaseService.getDatabases()]).subscribe(results => {\n        this.databases = results[1];\n        this.projects = results[0].filter(w => {\n          return w.databaseId != constants_angular_1.CNST_NO_OPTION_SELECTED.value;\n        }).map(w => {\n          w.databaseName = this.databases.find(db => {\n            return db.id === w.databaseId;\n          }).name;\n          return w;\n        });\n        this.po_lo_text = {\n          value: null\n        };\n      }, err => {\n        this._utilities.createNotification(constants_angular_1.CNST_LOGLEVEL.ERROR, workspace_messages_1.CNST_WORKSPACE_MESSAGES.WORKSPACE_LOADING_ERROR);\n        this.po_lo_text = {\n          value: null\n        };\n      });\n    }\n    editProject(w) {\n      this._router.navigate(['/workspace-add'], {\n        state: w\n      });\n    }\n    insertProject() {\n      this.modal_1.open();\n    }\n    modal_1_confirm() {\n      this.modal_1.close();\n      this._router.navigate(['/workspace-add'], {\n        state: {\n          contractType: this.contractType,\n          contractCode: this.contractCode\n        }\n      });\n    }\n    modal_1_close() {\n      this.contractType = null;\n      this.contractCode = null;\n      this.modal_1.close();\n    }\n    deleteProject(w) {\n      this.projectToDelete = w;\n      this.modal_2.open();\n    }\n    modal_2_confirm() {\n      this.modal_2.close();\n      this.po_lo_text = {\n        value: workspace_messages_1.CNST_WORKSPACE_MESSAGES.WORKSPACE_DELETE(this.projectToDelete.name)\n      };\n      this._workspaceService.deleteWorkspace(this.projectToDelete).subscribe(b => {\n        this._utilities.createNotification(constants_angular_1.CNST_LOGLEVEL.INFO, workspace_messages_1.CNST_WORKSPACE_MESSAGES.WORKSPACE_DELETE_OK);\n        this.po_lo_text = {\n          value: null\n        };\n        this.projectToDelete = null;\n        this.loadWorkspaces();\n      }, err => {\n        this._utilities.createNotification(constants_angular_1.CNST_LOGLEVEL.INFO, workspace_messages_1.CNST_WORKSPACE_MESSAGES.WORKSPACE_DELETE_ERROR(this.projectToDelete.name));\n        this.po_lo_text = {\n          value: null\n        };\n        this.projectToDelete = null;\n      });\n    }\n    modal_2_close() {\n      this.projectToDelete = null;\n      this.modal_2.close();\n    }\n  }\n  WorkspaceComponent.ɵfac = function WorkspaceComponent_Factory(t) {\n    return new (t || WorkspaceComponent)(i0.ɵɵdirectiveInject(i1.ElectronService), i0.ɵɵdirectiveInject(i2.WorkspaceService), i0.ɵɵdirectiveInject(i3.DatabaseService), i0.ɵɵdirectiveInject(i4.Utilities), i0.ɵɵdirectiveInject(i5.Router));\n  };\n  WorkspaceComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: WorkspaceComponent,\n    selectors: [[\"app-workspace\"]],\n    viewQuery: function WorkspaceComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n        i0.ɵɵviewQuery(_c1, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.modal_1 = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.modal_2 = _t.first);\n      }\n    },\n    decls: 20,\n    vars: 12,\n    consts: [[\"p-title\", \"Cadastro de Ambientes\"], [1, \"po-row\"], [\"p-label\", \"Adicionar\", \"p-icon\", \"po-icon po-icon-plus\", \"p-kind\", \"primary\", 1, \"padding-button\", 3, \"p-click\"], [\"p-property-title\", \"name\", 3, \"p-items\", \"p-actions\"], [\"p-list-view-content-template\", \"\"], [\"p-screen-lock\", \"true\", 3, \"hidden\", \"p-text\"], [\"p-title\", \"Preencha abaixo o produto contratado pelo cliente\", \"p-size\", \"auto\", \"p-hide-close\", \"true\", \"p-click-out\", \"true\", 3, \"p-primary-action\", \"p-secondary-action\"], [\"modal_1\", \"\"], [\"projectForm\", \"ngForm\"], [\"name\", \"po_contractType\", \"p-label\", \"Modalidade de Contrata\\u00E7\\u00E3o\", \"p-required\", \"true\", 1, \"form-control\", \"po-md-6\", 3, \"ngModel\", \"p-options\", \"ngModelChange\"], [\"name\", \"po_contractCode\", \"p-label\", \"C\\u00F3digo T do Cliente\", \"p-required\", \"true\", 1, \"form-control\", \"po-md-6\", 3, \"ngModel\", \"ngModelChange\"], [\"p-label\", \"Fechar\", 3, \"p-click\"], [\"p-label\", \"Confirmar\", \"p-kind\", \"primary\", 3, \"p-disabled\", \"p-click\"], [\"p-title\", \"Deseja realmente excluir este ambiente?\", 3, \"p-primary-action\", \"p-secondary-action\"], [\"modal_2\", \"\"], [\"p-label\", \"Confirmar\", \"p-kind\", \"primary\", 3, \"p-click\"], [\"p-label\", \"Ambiente\", 1, \"po-md-3\", 3, \"p-value\"], [\"p-label\", \"Graph\", 1, \"po-md-3\", 3, \"p-value\"], [\"p-label\", \"Banco de Dados\", 1, \"po-md-3\", 3, \"p-value\"], [\"p-label\", \"Contrata\\u00E7\\u00E3o\", 1, \"po-md-3\", 3, \"p-value\"]],\n    template: function WorkspaceComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"po-page-list\", 0)(1, \"div\", 1)(2, \"po-button\", 2);\n        i0.ɵɵlistener(\"p-click\", function WorkspaceComponent_Template_po_button_p_click_2_listener() {\n          return ctx.insertProject();\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(3, \"po-list-view\", 3);\n        i0.ɵɵtemplate(4, WorkspaceComponent_ng_template_4_Template, 5, 4, \"ng-template\", 4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(5, \"po-loading-overlay\", 5);\n        i0.ɵɵelementStart(6, \"po-modal\", 6, 7)(8, \"form\", null, 8)(10, \"po-select\", 9);\n        i0.ɵɵlistener(\"ngModelChange\", function WorkspaceComponent_Template_po_select_ngModelChange_10_listener($event) {\n          return ctx.contractType = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"po-input\", 10);\n        i0.ɵɵlistener(\"ngModelChange\", function WorkspaceComponent_Template_po_input_ngModelChange_11_listener($event) {\n          return ctx.contractCode = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(12, \"po-modal-footer\")(13, \"po-button\", 11);\n        i0.ɵɵlistener(\"p-click\", function WorkspaceComponent_Template_po_button_p_click_13_listener() {\n          return ctx.modal_1_close();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"po-button\", 12);\n        i0.ɵɵlistener(\"p-click\", function WorkspaceComponent_Template_po_button_p_click_14_listener() {\n          return ctx.modal_1_confirm();\n        });\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(15, \"po-modal\", 13, 14)(17, \"po-modal-footer\")(18, \"po-button\", 11);\n        i0.ɵɵlistener(\"p-click\", function WorkspaceComponent_Template_po_button_p_click_18_listener() {\n          return ctx.modal_2_close();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"po-button\", 15);\n        i0.ɵɵlistener(\"p-click\", function WorkspaceComponent_Template_po_button_p_click_19_listener() {\n          return ctx.modal_2_confirm();\n        });\n        i0.ɵɵelementEnd()()()();\n      }\n      if (rf & 2) {\n        const _r2 = i0.ɵɵreference(9);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"p-items\", ctx.projects)(\"p-actions\", ctx.setoptions());\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"hidden\", ctx.po_lo_text.value == null)(\"p-text\", ctx.po_lo_text.value);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"p-primary-action\", ctx.modal_1_confirm)(\"p-secondary-action\", ctx.modal_1_close);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.contractType)(\"p-options\", ctx._CNST_MODALIDADE_CONTRATACAO);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngModel\", ctx.contractCode);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"p-disabled\", !_r2.valid);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"p-primary-action\", ctx.modal_2_confirm)(\"p-secondary-action\", ctx.modal_2_close);\n      }\n    },\n    dependencies: [i6.ɵNgNoValidate, i6.NgControlStatus, i6.NgControlStatusGroup, i6.NgModel, i6.NgForm, i7.PoInfoComponent, i7.PoLoadingOverlayComponent, i7.PoModalComponent, i7.PoModalFooterComponent, i7.PoPageListComponent, i7.PoListViewComponent, i7.PoListViewContentTemplateDirective, i7.PoInputComponent, i7.PoSelectComponent, i7.PoButtonComponent]\n  });\n  return WorkspaceComponent;\n})();\nexports.WorkspaceComponent = WorkspaceComponent;","map":null,"metadata":{},"sourceType":"script","externalDependencies":[]}